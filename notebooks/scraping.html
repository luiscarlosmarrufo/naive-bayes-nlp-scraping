<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Equipo 1">

<title>Scraping</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="scraping_files/libs/clipboard/clipboard.min.js"></script>
<script src="scraping_files/libs/quarto-html/quarto.js"></script>
<script src="scraping_files/libs/quarto-html/popper.min.js"></script>
<script src="scraping_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="scraping_files/libs/quarto-html/anchor.min.js"></script>
<link href="scraping_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="scraping_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="scraping_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="scraping_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="scraping_files/libs/bootstrap/bootstrap-c0367b04c37547644fece4185067e4a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Scraping</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Equipo 1 </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(robotstxt)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.1.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter()         masks stats::filter()
✖ readr::guess_encoding() masks rvest::guess_encoding()
✖ dplyr::lag()            masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paths_allowed</span>(<span class="st">"https://www.yourghoststories.com/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
 www.yourghoststories.com                      </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Vamos a limitar los realtos a solamente Estados unidos, ya que es el unico pais que tambien especifica estado, para diferenciar mejor los lugares usaremos solo este pais, y nos basaremos en estado.</p>
<p>De todos modos si lo hacemos por paises, la mayoria de relatos son en estados unidos, entonces mejor trabajamos en este pais solamente.</p>
<p>Prueba con la primera pagina.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">"https://www.yourghoststories.com/ghost-stories-countries.php?country=US&amp;page=1"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>page</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{html_document}
&lt;html xmlns="https://www.w3.org/1999/xhtml"&gt;
[1] &lt;head&gt;\n&lt;title&gt;Real Ghost Stories from United States - Page 1 - Your Ghos ...
[2] &lt;body&gt;\r\n\r\n\r\n&lt;!-- Google tag (gtag.js) --&gt;\r\n&lt;script async src="htt ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(page)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(page)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "xml_document" "xml_node"    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pages <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">"a"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#pages</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>pages_subset <span class="ot">&lt;-</span> pages[<span class="dv">135</span><span class="sc">:</span><span class="dv">234</span>] <span class="co"># Los titulos de los relatos</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>pages_subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Startling Knocks At My Window"                          
  [2] "Move To San Francisco, A Very Haunted City"             
  [3] "Is Someone Visiting?"                                   
  [4] "Spirits From Ripley's"                                  
  [5] "Ghosts Of The Old Jail"                                 
  [6] "The Haunting Of Willows Apartments"                     
  [7] "Unexpected Messages From Loved Ones"                    
  [8] "My Grandma's House"                                     
  [9] "Oklahoma City Ghosts Part 2"                            
 [10] "Oklahoma City Ghosts Part 1"                            
 [11] "Oklahoma City Ghosts"                                   
 [12] "Tapping Noise"                                          
 [13] "Beyond The Known: Things Unseen, Things Unknown"        
 [14] "What Was Walking?"                                      
 [15] "Shadow Person Messing With My Wife"                     
 [16] "Old Farm House Experience"                              
 [17] "The Whistle"                                            
 [18] "\"we Don't Need You.\""                                 
 [19] "The Knocks On The Wall"                                 
 [20] "My Sleep Paralysis Episode"                             
 [21] "The Nightmare That Only Gets Worse"                     
 [22] "The Ghosts Of The Winding Staircase"                    
 [23] "Return Of The Dead"                                     
 [24] "The Bingham Light Continued Pt 2"                       
 [25] "Always Close Your Portals Kids"                         
 [26] "At Wind Cave"                                           
 [27] "At The Hermitage"                                       
 [28] "Paramedic - Creepy Doa"                                 
 [29] "Labor Day Encounter"                                    
 [30] "The Ghost In The Orange Grove"                          
 [31] "Family Experience"                                      
 [32] "I Just Wanted To Make A Reservation...?"                
 [33] "A Friendly Reminder"                                    
 [34] "My Experience At Work"                                  
 [35] "Abduction It Seems"                                     
 [36] "Doorbell Camera"                                        
 [37] "Cemetery Night To Remember"                             
 [38] "Loved Ones Visiting"                                    
 [39] "Unexpected Visit's"                                     
 [40] "Carol Street Has Some Reflecting To Do"                 
 [41] "Haunted In The Desert"                                  
 [42] "Timothy's Story"                                        
 [43] "Our Pet Poodle Barked At An Apparition"                 
 [44] "The Hippie Stared At My Brother"                        
 [45] "Possible Airbnb Ghost?"                                 
 [46] "Finding Their Way Home"                                 
 [47] "Unexplained Pillow Tapping"                             
 [48] "Spirit At Child Care Center"                            
 [49] "Haunted Property Inside And Outside"                    
 [50] "2nd Story Window Ghost"                                 
 [51] "Invisible But Solid"                                    
 [52] "The Ghost Nurse I Met That Night"                       
 [53] "Hypnagogic Hallucinations?"                             
 [54] "Restless Spirits"                                       
 [55] "Things Happening In Numbers Of Five"                    
 [56] "More Haunted Hotel Encounters"                          
 [57] "Haunted Hotel Encounters"                               
 [58] "U F Orange"                                             
 [59] "Black Hooded Shadow Figure And Two Black Cloaked People"
 [60] "I Think I Saw My Father's Doppelgänger"                 
 [61] "Haunted Historic Mansion In Akron"                      
 [62] "Did Something Followed Me?"                             
 [63] "Very Unexplained Experiences"                           
 [64] "Multiple Haunting Experiences Almost Everyday"          
 [65] "My Dad's Story"                                         
 [66] "Sounds During Solar Eclipse"                            
 [67] "Wth Case Files 2"                                       
 [68] "Historic Haunt"                                         
 [69] "Linkwood House"                                         
 [70] "Knocking At My Window?"                                 
 [71] "Seeing Red Eyes At Night, Need Help"                    
 [72] "The Haunting Of My House"                               
 [73] "Unfortunate Events"                                     
 [74] "Black Panther, Trying To Get My Foot"                   
 [75] "Two Fiascos, Two Unusual Rescues"                       
 [76] "Clicking Noises"                                        
 [77] "New House For Rent-the Ghost Is Free"                   
 [78] "Gaping Black Holes For Eyes"                            
 [79] "Sinister Smile Of A Black Ghost"                        
 [80] "Nursing Home 2nd Experience"                            
 [81] "Nursing Home 1st Experience"                            
 [82] "My Amazing Mother-in-law"                               
 [83] "Fascinated And Shook"                                   
 [84] "The Shadow I Saw At A Hotel I Was At"                   
 [85] "The Auto Bus Ghost Girl"                                
 [86] "The Hangry Ghost, Strange Sounds And The Shadow Hand"   
 [87] "The Senior Nursing Facility"                            
 [88] "What Did The Dog See?"                                  
 [89] "Thinning The Veil"                                      
 [90] "Room 113"                                               
 [91] "Disturbing Audio Evidence"                              
 [92] "The Old Maternity Hospital Part 2"                      
 [93] "The Old Maternity Hospital"                             
 [94] "Our Haunted First Apartment"                            
 [95] "A Life Saved By My Mother - 3 Years After Passing"      
 [96] "Larry, Looking For Trouble And Finding It"              
 [97] "The Slumber Party Incident"                             
 [98] "Dog Doesn't Believe That There's Nothing There"         
 [99] "The Old Parma Train Station Secretary"                  
[100] "Too Cold For Comfort"                                   </code></pre>
</div>
</div>
<p>We only need the 99 titles per page (nodes 24 to 123)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>links <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">"a"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">"href"</span>) <span class="co"># To extract the link</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>links_subset <span class="ot">&lt;-</span> links[<span class="dv">135</span><span class="sc">:</span><span class="dv">234</span>]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>links_subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "real-ghost-story.php?story=28577" "real-ghost-story.php?story=28570"
  [3] "real-ghost-story.php?story=28566" "real-ghost-story.php?story=28562"
  [5] "real-ghost-story.php?story=28561" "real-ghost-story.php?story=28557"
  [7] "real-ghost-story.php?story=28555" "real-ghost-story.php?story=28543"
  [9] "real-ghost-story.php?story=28529" "real-ghost-story.php?story=28528"
 [11] "real-ghost-story.php?story=28527" "real-ghost-story.php?story=28520"
 [13] "real-ghost-story.php?story=28517" "real-ghost-story.php?story=28514"
 [15] "real-ghost-story.php?story=28510" "real-ghost-story.php?story=28507"
 [17] "real-ghost-story.php?story=28505" "real-ghost-story.php?story=28504"
 [19] "real-ghost-story.php?story=28503" "real-ghost-story.php?story=28499"
 [21] "real-ghost-story.php?story=28493" "real-ghost-story.php?story=28479"
 [23] "real-ghost-story.php?story=28476" "real-ghost-story.php?story=28472"
 [25] "real-ghost-story.php?story=28466" "real-ghost-story.php?story=28442"
 [27] "real-ghost-story.php?story=28441" "real-ghost-story.php?story=28432"
 [29] "real-ghost-story.php?story=28429" "real-ghost-story.php?story=28427"
 [31] "real-ghost-story.php?story=28424" "real-ghost-story.php?story=28423"
 [33] "real-ghost-story.php?story=28422" "real-ghost-story.php?story=28420"
 [35] "real-ghost-story.php?story=28419" "real-ghost-story.php?story=28413"
 [37] "real-ghost-story.php?story=28412" "real-ghost-story.php?story=28410"
 [39] "real-ghost-story.php?story=28409" "real-ghost-story.php?story=28395"
 [41] "real-ghost-story.php?story=28384" "real-ghost-story.php?story=28373"
 [43] "real-ghost-story.php?story=28370" "real-ghost-story.php?story=28369"
 [45] "real-ghost-story.php?story=28368" "real-ghost-story.php?story=28363"
 [47] "real-ghost-story.php?story=28357" "real-ghost-story.php?story=28352"
 [49] "real-ghost-story.php?story=28349" "real-ghost-story.php?story=28340"
 [51] "real-ghost-story.php?story=28338" "real-ghost-story.php?story=28332"
 [53] "real-ghost-story.php?story=28329" "real-ghost-story.php?story=28323"
 [55] "real-ghost-story.php?story=28321" "real-ghost-story.php?story=28318"
 [57] "real-ghost-story.php?story=28317" "real-ghost-story.php?story=28316"
 [59] "real-ghost-story.php?story=28314" "real-ghost-story.php?story=28312"
 [61] "real-ghost-story.php?story=28311" "real-ghost-story.php?story=28310"
 [63] "real-ghost-story.php?story=28309" "real-ghost-story.php?story=28308"
 [65] "real-ghost-story.php?story=28307" "real-ghost-story.php?story=28306"
 [67] "real-ghost-story.php?story=28304" "real-ghost-story.php?story=28303"
 [69] "real-ghost-story.php?story=28302" "real-ghost-story.php?story=28299"
 [71] "real-ghost-story.php?story=28298" "real-ghost-story.php?story=28295"
 [73] "real-ghost-story.php?story=28294" "real-ghost-story.php?story=28287"
 [75] "real-ghost-story.php?story=28286" "real-ghost-story.php?story=28281"
 [77] "real-ghost-story.php?story=28280" "real-ghost-story.php?story=28275"
 [79] "real-ghost-story.php?story=28260" "real-ghost-story.php?story=28258"
 [81] "real-ghost-story.php?story=28257" "real-ghost-story.php?story=28256"
 [83] "real-ghost-story.php?story=28255" "real-ghost-story.php?story=28254"
 [85] "real-ghost-story.php?story=28249" "real-ghost-story.php?story=28245"
 [87] "real-ghost-story.php?story=28238" "real-ghost-story.php?story=28232"
 [89] "real-ghost-story.php?story=28226" "real-ghost-story.php?story=28221"
 [91] "real-ghost-story.php?story=28217" "real-ghost-story.php?story=28208"
 [93] "real-ghost-story.php?story=28207" "real-ghost-story.php?story=28202"
 [95] "real-ghost-story.php?story=28199" "real-ghost-story.php?story=28198"
 [97] "real-ghost-story.php?story=28196" "real-ghost-story.php?story=28194"
 [99] "real-ghost-story.php?story=28192" "real-ghost-story.php?story=28187"</code></pre>
</div>
</div>
<p>Test with the first story in the list</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>story1 <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">"https://www.yourghoststories.com/real-ghost-story.php?story=28570"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>story1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{html_document}
&lt;html xmlns="https://www.w3.org/1999/xhtml"&gt;
[1] &lt;head&gt;\n&lt;title&gt;Move To San Francisco, A Very Haunted City - Your Ghost St ...
[2] &lt;body&gt;\r\n\r\n\r\n&lt;!-- Google tag (gtag.js) --&gt;\r\n&lt;script async src="htt ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(story1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "xml_document" "xml_node"    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>title1 <span class="ot">&lt;-</span> story1 <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">".storytitle"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>title1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Move To San Francisco, A Very Haunted City"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>place <span class="ot">&lt;-</span> story1 <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">"a"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#place</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>place[<span class="dv">27</span><span class="sc">:</span><span class="dv">30</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Baikeru"        "United States"  "California"     "Haunted Places"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>state1 <span class="ot">&lt;-</span> story1 <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">"a"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  .[<span class="dv">28</span>]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>state1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "United States"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>cat1 <span class="ot">&lt;-</span> story1 <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">"a"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  .[<span class="dv">29</span>]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>cat1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "California"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>desc1 <span class="ot">&lt;-</span> story1 <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">"#story"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>desc1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ooookay, I was totally joking at the end of my last post when I said I'd post again in five years. But here it is, five years later. Looks like I'm going to be unintentionally posting every five years on here.\n\nOn 29 June 2021, I moved to San Francisco. It's where I'd always wanted to move, but couldn't for various reasons. Well, a really good friend of mine told me that I could live with them. They lived with their family and their family said I could stay until the end of the year, then I'd have to find my own place. That seemed perfectly fair.\n\nIn 2017, their grandmother passed away. I always assumed she passed away in the hospital because I remembered my friend telling me they rushed her to the hospital, and a few days later they told me she passed. But every time I was by the bathroom in front of her old room, I'd get this strange feeling there was a presence. That little hallway had that feeling. It didn't feel evil or scary, it actually felt calming. I told my friend, and they said, \"That's Baachan. She's watching over us\". My friend is Japanese and that's the term they call their grandmother. I asked if she passed in the hospital like I thought, and they said, \"No, she hated it there. We brought her home to rest in her own bed, and she passed away that night\".\n\nHowever, the basement was another story. Or rather... First floor? Basements are weird here in San Francisco. In their house and the one I'm currently living, there are steps leading to second floor, which acts as the first floor. The ground floor is considered a basement even though it's fully above ground. I've lived here four years, and I'm still confused by it. I live on the third floor but it's technically the second floor...\n\nAnyway, we had to go to the basement to do laundry. We never liked being down there because the air felt thick and evil. My friend's family had bought the house back in the 1950s and their mother had grown up in it, and she told me it was like that when she was a little girl. She hated being down there and doesn't go down there unless she has to. I asked if something happened down there and she said if it did it was before her family bought the house, but it definitely feels like some really bad energy is down there.\n\nSo, I got a job there, saved up and moved into my current house on 5 January 2022. I'm renting a room in a house, and it's a really nice neighbourhood in the Richmond. That's not doxing myself, the Richmond is fifty blocks long and like ten blocks wide. It's a very big area.\n\nIt didn't take me long to notice that the house was haunted. At least the hallway. Even in the daytime I feel like something is chasing me when I walk down it and I rush back to my room. A friend of mine looked up this address on SF Chronicles archives and found out there had been a murder here in the '80s. There weren't any specific details like if it was in the top floor hallway or something. But that's the only thing we found that could explain it.\n\nThere are four rooms on my floor. My room is at the end of the hall facing the outside. I look out my window and see the street. The room next to mine, there was someone living there when I moved out. He moved out a year into me living here and someone else moved in, he's still here. The room at the end of the hall, the same person has lived there since before I moved in. I mention all this to talk about the last room. I call it the middle room even though there are four rooms. I guess it'd be the middle room in that hall, since mine is at the end of the hall. Anyway, I've always called it the cursed room. The guy who was living there when I moved in moved out a month later. In the three and a half years I've lived in this house, we've had six different people move in and out. The short time was two weeks. I came home from work and he was moving his stuff out. I asked what was going on and he just said, \"I can't do this anymore\". I asked what he meant and he just repeated it. The current tenant there seems to be paranoid. When he moved in a couple months ago, he told me that he had to move out of his last place because his landlord was having the tenants spy on him. I was like, \"Oh, that's messed up!\". But then he started talking about hidden cameras in his room and I felt like maybe his last landlord didn't have him spied on. A couple weeks ago I was coming up the stairs from taking out the trash. His room is directly in front of the stairs, and as I was nearing the top, he opened his door and told me I needed to stop standing outside his door listening in. I was confused and he said, \"Don't bother denying it, I caught you three times\". The other way I was coming up the stairs from talking with a friend at the front door who had come to pick up something. As I was nearing the top he threw open his door and startled me. I laughed and told him he startled me. He goes, \"I told you to stay out of my room! You need to leave me alone!\". Honestly, I don't know if that has anything to do with the activity here or if he's just mentally ill, but I honestly wouldn't be surprised if there was a presence outside his room and he thinks it's one of us.\n\nSomething happened a couple of days ago that made me want to write all this down. Our bathroom is split between two rooms. Okay, from my room looking down the hall, on the left side are my roommates' rooms. On the left side is an empty closet, the stairs, and the two bathroom doors, and the kitchen at the end of the hall. The first bathroom is literally just the toilet, the size of a porta-potty. Really tiny. The second door is the shower and sink. It sounds inconvenient, but with four people living there, it's been very convenient. Anyway, a couple days ago I was in the first bathroom and I could hear someone taking a shower. I could see the light on, and the windows were open and I could very clearly hear the shower going. I was thinking to myself, \"I'll just wash my hands in the kitchen\", like we usually do in that situation. Well, I leave the bathroom, the sound still going and light still on through the window, and when I close the door behind me... The second bathroom door is open, and the light is off and no one is in there. No shower going, the floor and walls are dry. I stood there, my blood frozen. It was seriously eerie.\n\nOkay, that's enough about my living haunting situations. I'll talk about my San Francisco working haunting situations. That's a weird wording, but I'm going to keep it.\n\nFirst job I got was on Fisherman's Wharf at a souvenir shop standing outside going, \"Everything is $10!\". That was literally my entire job. That's the job that paid for me to move out of my friend's house. But a week after I moved into this house, the store abruptly closed. I frantically looked for another one and was lucky enough to find one with one day left in the month. My landlord is very understanding. It was an organic market on Polk, and I loved it there. A lot of the friends I have made here were either coworkers there or regular customers there. A minor celebrity was a regular there and she and I talked every week. It was so much fun working there! Even if it was haunted like crazy! There was the obvious stuff like stuff falling off shelves that weren't near the edge, stuff moving around or not where we left them. There were times we saw figures cross between aisles even though we knew no one else was in the store. I even had a similar experience that happened in Ohio. A coworker and I were discussing the hauntings, and a loaf of bread flew off the shelf and hit the counter. We decided to change the subject. The same thing happened in Ohio except it was a bag of chips.\n\nIn 2023 the store was bought by another, bigger store and closed down and we were all let go. I had saved up thousands of dollars by then, which was lucky because that paid my rent until I got another job in March 2024. My current job, in fact. I'm a photographer at a landmark. Obviously not going to say which one. We take pictures of guests as they enter and try to sell them souvenir sets of their photos as they leave. We all know the area is haunted, but it's hard to prove because we're outside. We just know mostly because we can feel it. There were two incidents that really solidified it, though. Several months ago, I opened up (I'm a lead there) and when I unlocked the office there were photo cards everywhere. I called the person who closed the night before and asked them what the heck happened. He was completely confused; it wasn't like that when he left. I knew he was lying so I had to report it to my district manager. An hour later she texted me a video showing that... It wasn't him. Oh, the photo cards are cards with QR codes we scan when we take the pictures and hand to the guests. There are 1,000 in each box. Anyway, there was an open box on the table in the office and in the middle of the night, they started flying out of the box of their own accord. I asked her if I could share the video and she said absolutely not. What's with corporate not wanting these things getting out? Honestly, I think that'd give us more visitors. \n\nThe other thing that happened was we often hear our names called from behind the sales area. There will be no one over there and one of us will hear our name being called from back there. No one else can hear it, but almost all of us have heard it. Even the skeptical ones have heard it, though they have tried to dismiss it as the wind. But it even happens when the wind isn't blowing, or even no breeze. The air could be still and we'll still hear it. It's always eerie. I've been working there for a year and a half and have heard it many times and am not used to it. We had a sixteen-year-old girl start working there last year. I was standing next to her on her first night and she suddenly screamed. I jumped and asked what happened. She said, \"I heard someone saying my name!\" and she ran behind the sales area and screamed again because no one was back there. I involuntarily laughed and said, \"Oh, you'll get used to that\", even though like I said I'm still not used to it. Needless to say, she quit after about a week. She said it was because she hated working outside, though.\n\nI'm going to end this by talking about something nobody likes talking about. I've walked the Golden Gate Bridge so many times now that I don't even take pictures every time anymore. It's just a large bridge that just happens to be one of the most famous in the world. No big deal. But as I'm sure everyone knows, it's well-known for the unfortunately high number of people who have jumped off of it over the course of its existence. I don't know if you've walked on it, but you can definitely feel it when you're walking on it. There's an air of sadness when you're walking across it. No matter what I'm doing, be it listening to happy music or in a call with my best friend, there's an unmistakable feeling of sadness, dread, and regret when walking on that bridge. I've never specifically seen anything, but I think it's because I'm kind of sensitive to that sort of thing that I feel it so much. I've walked it with a friend of mine once who isn't sensitive to the paranormal and she didn't feel anything. Heck, at this point, I don't even know if what I feel on the bridge is even paranormal anymore. There's been so many jumpers over the past century, those emotions are essentially baked in by now. They have nets in place now so there have been less attempts lately. Someone did jump a couple months ago. I saw him lying on the net refusing help. Last I saw, they were guiding him off. So, the nets are definitely saving lives. Either as a deterrent or by literally catching people who try.\n\nI guess I'll see you all in five years lol."</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>desc1_clean <span class="ot">&lt;-</span> desc1 <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span>                  <span class="co"># lowercase</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">n"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span>     <span class="co"># remove line breaks</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">"[^a-z ]"</span>, <span class="st">" "</span>) <span class="sc">%&gt;%</span> <span class="co"># keep only letters + spaces</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_squish</span>()                        <span class="co"># trim + collapse spaces</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>desc1_clean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ooookay i was totally joking at the end of my last post when i said i d post again in five years but here it is five years later looks like i m going to be unintentionally posting every five years on here on june i moved to san francisco it s where i d always wanted to move but couldn t for various reasons well a really good friend of mine told me that i could live with them they lived with their family and their family said i could stay until the end of the year then i d have to find my own place that seemed perfectly fair in their grandmother passed away i always assumed she passed away in the hospital because i remembered my friend telling me they rushed her to the hospital and a few days later they told me she passed but every time i was by the bathroom in front of her old room i d get this strange feeling there was a presence that little hallway had that feeling it didn t feel evil or scary it actually felt calming i told my friend and they said that s baachan she s watching over us my friend is japanese and that s the term they call their grandmother i asked if she passed in the hospital like i thought and they said no she hated it there we brought her home to rest in her own bed and she passed away that night however the basement was another story or rather first floor basements are weird here in san francisco in their house and the one i m currently living there are steps leading to second floor which acts as the first floor the ground floor is considered a basement even though it s fully above ground i ve lived here four years and i m still confused by it i live on the third floor but it s technically the second floor anyway we had to go to the basement to do laundry we never liked being down there because the air felt thick and evil my friend s family had bought the house back in the s and their mother had grown up in it and she told me it was like that when she was a little girl she hated being down there and doesn t go down there unless she has to i asked if something happened down there and she said if it did it was before her family bought the house but it definitely feels like some really bad energy is down there so i got a job there saved up and moved into my current house on january i m renting a room in a house and it s a really nice neighbourhood in the richmond that s not doxing myself the richmond is fifty blocks long and like ten blocks wide it s a very big area it didn t take me long to notice that the house was haunted at least the hallway even in the daytime i feel like something is chasing me when i walk down it and i rush back to my room a friend of mine looked up this address on sf chronicles archives and found out there had been a murder here in the s there weren t any specific details like if it was in the top floor hallway or something but that s the only thing we found that could explain it there are four rooms on my floor my room is at the end of the hall facing the outside i look out my window and see the street the room next to mine there was someone living there when i moved out he moved out a year into me living here and someone else moved in he s still here the room at the end of the hall the same person has lived there since before i moved in i mention all this to talk about the last room i call it the middle room even though there are four rooms i guess it d be the middle room in that hall since mine is at the end of the hall anyway i ve always called it the cursed room the guy who was living there when i moved in moved out a month later in the three and a half years i ve lived in this house we ve had six different people move in and out the short time was two weeks i came home from work and he was moving his stuff out i asked what was going on and he just said i can t do this anymore i asked what he meant and he just repeated it the current tenant there seems to be paranoid when he moved in a couple months ago he told me that he had to move out of his last place because his landlord was having the tenants spy on him i was like oh that s messed up but then he started talking about hidden cameras in his room and i felt like maybe his last landlord didn t have him spied on a couple weeks ago i was coming up the stairs from taking out the trash his room is directly in front of the stairs and as i was nearing the top he opened his door and told me i needed to stop standing outside his door listening in i was confused and he said don t bother denying it i caught you three times the other way i was coming up the stairs from talking with a friend at the front door who had come to pick up something as i was nearing the top he threw open his door and startled me i laughed and told him he startled me he goes i told you to stay out of my room you need to leave me alone honestly i don t know if that has anything to do with the activity here or if he s just mentally ill but i honestly wouldn t be surprised if there was a presence outside his room and he thinks it s one of us something happened a couple of days ago that made me want to write all this down our bathroom is split between two rooms okay from my room looking down the hall on the left side are my roommates rooms on the left side is an empty closet the stairs and the two bathroom doors and the kitchen at the end of the hall the first bathroom is literally just the toilet the size of a porta potty really tiny the second door is the shower and sink it sounds inconvenient but with four people living there it s been very convenient anyway a couple days ago i was in the first bathroom and i could hear someone taking a shower i could see the light on and the windows were open and i could very clearly hear the shower going i was thinking to myself i ll just wash my hands in the kitchen like we usually do in that situation well i leave the bathroom the sound still going and light still on through the window and when i close the door behind me the second bathroom door is open and the light is off and no one is in there no shower going the floor and walls are dry i stood there my blood frozen it was seriously eerie okay that s enough about my living haunting situations i ll talk about my san francisco working haunting situations that s a weird wording but i m going to keep it first job i got was on fisherman s wharf at a souvenir shop standing outside going everything is that was literally my entire job that s the job that paid for me to move out of my friend s house but a week after i moved into this house the store abruptly closed i frantically looked for another one and was lucky enough to find one with one day left in the month my landlord is very understanding it was an organic market on polk and i loved it there a lot of the friends i have made here were either coworkers there or regular customers there a minor celebrity was a regular there and she and i talked every week it was so much fun working there even if it was haunted like crazy there was the obvious stuff like stuff falling off shelves that weren t near the edge stuff moving around or not where we left them there were times we saw figures cross between aisles even though we knew no one else was in the store i even had a similar experience that happened in ohio a coworker and i were discussing the hauntings and a loaf of bread flew off the shelf and hit the counter we decided to change the subject the same thing happened in ohio except it was a bag of chips in the store was bought by another bigger store and closed down and we were all let go i had saved up thousands of dollars by then which was lucky because that paid my rent until i got another job in march my current job in fact i m a photographer at a landmark obviously not going to say which one we take pictures of guests as they enter and try to sell them souvenir sets of their photos as they leave we all know the area is haunted but it s hard to prove because we re outside we just know mostly because we can feel it there were two incidents that really solidified it though several months ago i opened up i m a lead there and when i unlocked the office there were photo cards everywhere i called the person who closed the night before and asked them what the heck happened he was completely confused it wasn t like that when he left i knew he was lying so i had to report it to my district manager an hour later she texted me a video showing that it wasn t him oh the photo cards are cards with qr codes we scan when we take the pictures and hand to the guests there are in each box anyway there was an open box on the table in the office and in the middle of the night they started flying out of the box of their own accord i asked her if i could share the video and she said absolutely not what s with corporate not wanting these things getting out honestly i think that d give us more visitors the other thing that happened was we often hear our names called from behind the sales area there will be no one over there and one of us will hear our name being called from back there no one else can hear it but almost all of us have heard it even the skeptical ones have heard it though they have tried to dismiss it as the wind but it even happens when the wind isn t blowing or even no breeze the air could be still and we ll still hear it it s always eerie i ve been working there for a year and a half and have heard it many times and am not used to it we had a sixteen year old girl start working there last year i was standing next to her on her first night and she suddenly screamed i jumped and asked what happened she said i heard someone saying my name and she ran behind the sales area and screamed again because no one was back there i involuntarily laughed and said oh you ll get used to that even though like i said i m still not used to it needless to say she quit after about a week she said it was because she hated working outside though i m going to end this by talking about something nobody likes talking about i ve walked the golden gate bridge so many times now that i don t even take pictures every time anymore it s just a large bridge that just happens to be one of the most famous in the world no big deal but as i m sure everyone knows it s well known for the unfortunately high number of people who have jumped off of it over the course of its existence i don t know if you ve walked on it but you can definitely feel it when you re walking on it there s an air of sadness when you re walking across it no matter what i m doing be it listening to happy music or in a call with my best friend there s an unmistakable feeling of sadness dread and regret when walking on that bridge i ve never specifically seen anything but i think it s because i m kind of sensitive to that sort of thing that i feel it so much i ve walked it with a friend of mine once who isn t sensitive to the paranormal and she didn t feel anything heck at this point i don t even know if what i feel on the bridge is even paranormal anymore there s been so many jumpers over the past century those emotions are essentially baked in by now they have nets in place now so there have been less attempts lately someone did jump a couple months ago i saw him lying on the net refusing help last i saw they were guiding him off so the nets are definitely saving lives either as a deterrent or by literally catching people who try i guess i ll see you all in five years lol"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>story1_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> title1,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">place =</span> state1,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> cat1,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> desc1_clean</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>story1_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  title                                      place         type      description
  &lt;chr&gt;                                      &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;      
1 Move To San Francisco, A Very Haunted City United States Californ… ooookay i …</code></pre>
</div>
</div>
<p>Great, so this pipeline is going to work for every story in the US, now lets construct a dataframe, for simplicity of handling the calls, we are going to use Python.</p>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>